100 CALL LINK("SCRN2")
110 call clear
120 CALL LINK("SCREEN",2)
130 call magnify(4)
140 call autochar
150 gosub 240
160 gosub 250
170 gosub 610
180 call clear
190 display at(10,5):"Play again? (Y/N)"
200 call key(3,k,s)
210 IF NOT (s=1) THEN 200
220 IF NOT (k=78) THEN 150
230 end
240 return
250 call clear
260 call char( 92,"00007E7F7F7F7E7E7E7E7E7E7F7F3F18")
270 call char( 94,"00073FFFFFFFFFFFFFFFFFFFFFFFC000")
280 call char( 96,"00F0FEFFFFFFFFFFFFFFFFFFFFFF0100")
290 call char( 98,"00003FFFFFFFBFBFBFBFBFBFFFFFFE0C")
300 call char(100,"0C0E0F0E0E0E0F0E0E0E0E0F0E0E0E0E")
310 call char(102,"0000FFFF7F3FFF3F3F3F3FFF3F3F3F3F")
320 call char(104,"0000FFFFFFFEFFFEFEFEFEFFFEFEFEFE")
330 call char(106,"1838F8B83838F838383838F838383838")
340 call char(108,"0E0E1F3F7E7E6E6E6E6E6F6E7F7F0000")
350 call char(110,"3F3FFFFF3F3F3F3F3F3FE000FFC00000")
360 call char(112,"FEFEFFFFFEFEFEFEFEFE0300FF010000")
370 call char(114,"3838FCFE3F3F3B3B3B3BFB3BFFFF0000")
380 call sprite(#1, 92,15, 50,50,#2, 96,15, 50,82)
390 call sprite(#3,100,15, 82,50,#4,104,15, 82,82)
400 call sprite(#5,108,15,114,50,#6,112,15,114,82)
410 call char(116,"3F0C000000000000000000000000000000000000000000000000000000000000")
420 call char(120,"183C000000000000000000000000000000000000000000000000000000000000")
430 call sprite(#7,116,10,143,50, #8,116,10,143, 96)
440 call sprite(#9,120,16, 49,50,#10,120,16, 49,100)
450 CALL LINK("COLOR2",31,12,2)
460 x1=50
470 gy=-10
480 call joyst(1,x,y)
490 x1=x1+x/2
500 if x1<1   then x1=2
510 if x1>190 then x1=190
520 x2=x1+32
530 call locate(#1,50,x1,#2,50,x2,#3,82,x1,#4,82,x2,#5,114,x1,#6,114,x2,#7,143,x1,#8,143,x2+14,#9,49,x1,#10,49,x2+18)
540 CALL LINK("SCRLDN")
550 gy=gy+1
560 if gy=10 then gy=-10
570 if gy<0 then call hchar(1,9,16,1) :: call hchar(1,20,16,1)
580 CALL LINK("DELAY",40)
590 IF NOT (1=2) THEN 480
600 return
610 CALL CHAR( 92,"010100000000000000000000000000008080C0C06060303018180C0C06060303")
620 CALL CHAR( 96,"0101030306060C0C181830306060C0C080800000000000000000000000000000")
630 CALL CHAR(100,"0303231109070303030202040D000000808080A0A0A0A0A08080808080000000")
640 CALL CHAR(104,"01010105050505050101010101000000C0C0C48890E0C0C0C0404020B0000000")
650 CALL CHAR(108,"01070D1F1908080E3F2F2F272733010000C060F0302020E0F0D0D090B01080C0")
660 CALL CHAR(112,"3F40FFFF0000000000000000000000000080C0C0000000000000000000000000")
670 CALL CHAR(116,"0000000000000000000000041F377CFF0000000000000000000000D07CEEDEFF")
680 CALL CHAR(120,"60C0C0C0C0C0E0783F0F030303030303060303030303071EFCF0C0C0C0C0C0C0")
690 CALL LINK("COLOR2",29,5,15)
700 CALL LINK("COLOR2",30,5,15)
710 CALL LINK("COLOR2",31,12,2)
720 for i=4 to 15
730 call hchar(i,5,11,24)
740 next i
750 call hchar(16,1,10,32)
760 for i=5 to 13 step 4
770 for j=6 to 27 step 4
780 call hchar(i,j,6,1)
790 call hchar(i+1,j,7,1)
800 call hchar(i,j+1,8,1)
810 call hchar(i+1,j+1,9,1)
820 next j
830 next i
840 call sprite(#10,100,9,132,200)
850 call sprite(#12,108,13,50,150)
860 call sprite(#13,112,11,140,200)
870 a$=bin$("0498394c80e3752ab85705acfaae80955f1835538353ad25c0b7610cf8358301bfa513e0af7402fc9d4e805fda10705531cb33f37e4b75aac8dceb3cd49b3489ce16cb6e8ad85335264b288bc956f776ad1cda32d2938d6ae8f0084d3bea1133c2d56dab7bca")
880 b$=bin$("34956da5ed294254b785b6250e4ddf22f062a93a3a31a9a3f4d8543b046cd22d2b6c23b031d3887083c042d56a3a2923472a668fac0ced2d5cc5fa88718c080eed2bc6f17248bc0b01c66e47c02eee08d8a91c01cb972360bb72046c9f8e80edca10b06c28")
890 sp$=chr$(96) & chr$(0) & chr$(LEN(a$)+LEN(b$)) & a$ & b$
900 state=1
910 x=200
920 gx=70
930 gy=50
940 call key(1,k,s)
950 if s=-1 then k=0
960 call joyst(1,jx,jy)
970 on state gosub 1120,1210,1310,1450,1620
980 gxd = gxd + (rnd*11)-5
990 gyd = gyd + (rnd*11)-5
1000 call position(#12,gy,gx)
1010 if gx<30  then gxd=rnd*10+1
1020 if gx>200 then gxd=-rnd*10-1
1030 if gy<30  then gyd=rnd*10+1
1040 if gy>70  then gyd=-rnd*10-1
1050 if state>3 then GOSUB 20000
1060 if GBND=2 then GXD=0 :: GYD = 10
1070 if state<6 then call motion(#12,gyd,gxd)
1080 CALL LINK("DELAY",50)
1090 IF NOT (state>5) THEN 940
1100 if state=6 then gosub 1540
1110 return
1120 x=max(x+jx,4)
1130 if jx<>0 then call pattern(#10,100-4*(jx=4))
1140 call locate(#10,132,x)
1150 call locate(#13,140,x)
1160 if k<>18 then return
1170 trx = int(x/8)*8+3
1180 call locate(#13,153,trx)
1190 state = state + 1
1200 return
1210 x=max(x+jx,4)
1220 if jx<>0 then call pattern(#10,100-4*(jx=4))
1230 call locate(#10,132,x)
1240 if k<>18 then return
1250 call pattern(#10,104)
1260 call sprite(#11,100,9,132,200)
1270 x1=x
1280 x=200
1290 state = state + 1
1300 return
1310 x=x+jx
1320 if jx<>0 then call pattern(#11,100-4*(jx=4))
1330 call locate(#11,132,x)
1340 if k<>18 then return
1350 call pattern(#11,100)
1360 x2 = x
1370 call sprite(#1,94,4,40,x2-60)
1380 call sprite(#2,94,4,72,x2-44)
1390 call sprite(#3,94,4,104,x2-28)
1400 call sprite(#4,98,4,40,x1+60)
1410 call sprite(#5,98,4,72,x1+44)
1420 call sprite(#6,98,4,104,x1+28)
1430 state = state + 1
1440 return
1450 x1=x1-4*(jx=4)
1460 x2=x2+4*(jx=-4)
1470 if jx=4  then call locate(#10,132,x1,#4,40,x1+60,#5,72,x1+44,#6,104,x1+28)
1480 if jx=-4 then call locate(#11,132,x2,#1,40,x2-60,#2,72,x2-44,#3,104,x2-28)
1490 if k<>18 then return
1500 state=5
1510 try=123
1520 call sprite(#14,120,12,123,trx-6)
1530 return
1540 call delsprite(#1,#2,#3,#4,#5,#6)
1550 call pattern(#10,116,#11,116)
1560 call motion(#12,-5,5)
1570 CALL LINK("DISPLY",1,5,"You crossed the streams!")
1580 call position(#12,gy,gx)
1590 IF NOT (gy<5 or gx>250) THEN 1580
1600 call delsprite(#12)
1610 return
1620 if try >20 then try=try-2 else state=8
1630 call locate(#14,try,trx-6)
1640 if try-int(try/8)*8=1 then GOSUB 20090
1650 call distance(#12,#14,e)
1660 if e<800 or state=8 then GOSUB 20130
1670 return
1680 END
20000 dx = gx - (x1+28 + (135-gy)/2)
20010 GBND=0
20020 if dx<-5 and dx>-20 then gxd=5 :: call sound(-200,110,0) :: GBND=1
20030 if dx<-20 and dx>-40 then gxd=-5 :: call sound(-200,220,0)
20040 dx = gx - (x2 - (135-gy)/2)
20050 if dx<5 and dx>-20 then gxd=-5 :: call sound(-200,440,0) :: GBND = GBND+1
20060 if dx>5 and dx<15 then gxd=5  :: call sound(-200,880,0)
20070 if state<5 and x2-x1<125 then state=6
20080 RETURN
20090 call gchar(try/8+4,trx/8+2,c)
20100 call hchar(try/8+4,trx/8+2,16,1)
20110 bg$=bg$&chr$(c)
20120 RETURN
20130 for try=try to 123 step 2
20140 call locate(#14,try,trx-6)
20150 if state=8 then call locate(#12,gy-8+rnd*4,gx-8+rnd*4) else call locate(#12,try,trx-9+rnd*6)
20160 if try-int(try/8)*8=1 then GOSUB 20320
20170 CALL LINK("DELAY",40)
20180 next try
20190 call delsprite(#12,#14,#1,#2,#3,#4,#5,#6)
20200 if state=8 then GOSUB 20350 else call color(#13,3)
20210 GOTO 20280
20220 x1=x1+4
20230 if x1=trx-3 then call locate(#13,140,trx) :: trx=trx+4
20240 call locate(#10,132,x1)
20250 if x1=x2-40 then call pattern(#11,104)
20260 if x2<x1-30 then call locate(#11,132,x2) :: x2=x2+4
20270 CALL LINK("DELAY",50)
20280 IF x1<250 THEN 20220
20290 call delsprite(#10,#11,#13)
20300 state=7
20310 RETURN
20320 call hchar(try/8+4,trx/8+2,asc(seg$(bg$,len(bg$),1)))
20330 bg$=seg$(bg$,1,len(bg$)-1)
20340 RETURN
20350 for i=1 to 132-gy
20360 call locate(#12,gy+i,gx+i*(x2-gx)/(132-gy))
20370 CALL LINK("DELAY",40)
20380 next i
20390 call color(#11,3)
20400 call motion(#12,-5,5)
20410 call position(#12,gy,gx)
20420 IF NOT (gy<5 or gx>250) THEN 20410
20430 call delsprite(#12)
20440 RETURN
30000 SUB AUTOCHAR
30010 CALL LINK("CHAR2",0,"FF8888FF2222FF8888FF2222FF8888FFFF8888FF80BFBFBFBFBFBF80FF8888FFFF8888FF22A2BFA8")
30020 CALL LINK("CHAR2",5,"A8BFA222FF8888FF007F405F5F5F5F5F5F5F5F5F407F000000FE02FAFAFAFAFAFAFAFAFA02FE0000")
30030 CALL LINK("CHAR2",10,"88002200FFFF00FF8800220088002200")
30040 CALL LINK("CHAR2",16,"FFFFFFFFFFFFFFFF")
30050 SUBEND
